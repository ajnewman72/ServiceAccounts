<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_entry">
    <sys_transform_entry action="INSERT_OR_UPDATE">
        <choice_action>reject</choice_action>
        <coalesce>false</coalesce>
        <coalesce_case_sensitive>false</coalesce_case_sensitive>
        <coalesce_empty_fields>false</coalesce_empty_fields>
        <date_format>yyyy-MM-dd HH:mm:ss</date_format>
        <map display_value="lloy_serviceaccount_tmap">459d5daa930e5610879df0e48aba10b7</map>
        <reference_value_field/>
        <source_field>[Script]</source_field>
        <source_script><![CDATA[answer = (function transformEntry(source) {

    // Get the service name from the source record
    if (source.u_service_name!='Not found in cmdb' && source.u_service_name!='') {
        var serviceName = source.u_service_name;
    	//gs.info("AJN serviceName is: " + serviceName);
        // Query the cmdb_ci_service table for a matching operational service
        var serviceGR = new GlideRecord('cmdb_ci_service');
        serviceGR.addQuery('name', serviceName);
        serviceGR.addQuery('operational_status', '1'); // As '1' is the value for operational
        serviceGR.query();
        //gs.info("AJN serviceGR rowcount is: " + serviceGR.getRowCount());
        // If a matching service is found, set the associated_service field on the target record
        if (serviceGR.next()) {
            return serviceGR.sys_id;
        } else {
            // Handle the case where no matching service is found
            gs.info('No matching operational service found for: ' + serviceName);
        }
    }
})(source);]]></source_script>
        <source_table>x_llol_service_acc_lloy_serviceaccount_impset</source_table>
        <sys_class_name>sys_transform_entry</sys_class_name>
        <sys_created_by>sup_newmanan</sys_created_by>
        <sys_created_on>2024-11-26 12:00:27</sys_created_on>
        <sys_id>fb1ed5aa930e5610879df0e48aba1051</sys_id>
        <sys_mod_count>20</sys_mod_count>
        <sys_name>[Script]</sys_name>
        <sys_package display_value="Service Accounts" source="x_llol_service_acc">cfccdb1293281a10879df0e48aba10ef</sys_package>
        <sys_policy/>
        <sys_scope display_value="Service Accounts">cfccdb1293281a10879df0e48aba10ef</sys_scope>
        <sys_update_name>sys_transform_entry_fb1ed5aa930e5610879df0e48aba1051</sys_update_name>
        <sys_updated_by>sup_newmanan</sys_updated_by>
        <sys_updated_on>2024-12-04 15:51:07</sys_updated_on>
        <target_field>associated_service</target_field>
        <target_table>x_llol_service_acc_records</target_table>
        <use_source_script>true</use_source_script>
    </sys_transform_entry>
</record_update>
